# Bybit → Jupiter
  
## 变量定义

- **U**：Bybit 端初始 USDT 数量  
- **B**：Bybit 上代币价格（USDT/枚）  
- **J**：Jupiter 上代币价格（USDT/枚）  
- **sᴮ**：Bybit 端滑点容忍度（小数形式）  
- **sᴶ**：Jupiter 端预期滑点（小数形式，取值0.001）
- **w**：Bybit 提币手续费（USDT，绝对值）  
- **gas**：Jupiter 端 Gas 成本（固定 0.001 USDT）  
- **fee_bybit**：Bybit 买入手续费（0.01）

## 交易流程

1. **在 Bybit 买入**

考虑滑点与手续费后的实际买入价格：
  
$$B_{\text{eff}} = B(1 + sᴮ)(1 + fee_{\text{bybit}})$$
  
买入后获得的代币数量：

$$t = \frac{U - w}{B_{\text{eff}}}$$


2. **在 Jupiter 卖出**

考虑滑点后的实际卖出价格：

$$J_{\text{eff}} = J(1 - sᴶ)$$

卖出后获得的 USDT 数量：

$$\text{proceeds} = t \times J_{\text{eff}} - gas$$

## 无亏损条件（含双滑点）

要求最终获得的 USDT 不低于初始投入：

$$\frac{(U - w)J \times 0.999}{B(1 + sᴮ) \times 1.01} - 0.001 - U \ge 0$$

整理后得到：

$$J \ge B(1 + sᴮ) \times 1.01 \times \frac{U + 0.001}{(U - w) \times 0.999}$$

或等价的价差阈值形式：

$$J - B \ge B\left[ (1 + sᴮ) \times 1.01 \times \frac{U + 0.001}{(U - w) \times 0.999} - 1 \right]$$



## Bybit 滑点上限推导

在盈亏平衡点上：

$$\frac{(U - w)J \times 0.999}{B(1 + sᴮ) \times 1.01} - 0.001 - U = 0$$

解得：

$$sᴮ_{\text{max}} = \frac{J \times 0.999 \times (U - w)}{B \times 1.01 \times (U + 0.001)} - 1$$



## 预期利润计算

套利的预期利润为最终获得的 USDT 减去初始投入：

$$\text{profit} = t \times J_{\text{eff}} - gas - U$$

将各项代入：

$$\text{profit} = \frac{U - w}{B(1 + sᴮ) \times 1.01} \times J \times 0.999 - 0.001 - U$$

整理后：

$$\text{profit} = \frac{(U - w)J \times 0.999}{B(1 + sᴮ) \times 1.01} - 0.001 - U$$